<!DOCTYPE html>
<html lang="zh">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="The Super Tiny Compiler（下）本文是The Super Tiny Compiler的翻译，可以通过本文学习如何实现一个编译器。本文并非严格按照字面直译，如有理解错误，还请指正。本篇主要是编译器具体实现。
The Super Tiny Compiler（上）
正文翻译中…
THE"/>
    

    <!--Author-->
    
        <meta name="author" content="weyos"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="The Super Tiny Compiler（下）"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="The Super Tiny Compiler（下）本文是The Super Tiny Compiler的翻译，可以通过本文学习如何实现一个编译器。本文并非严格按照字面直译，如有理解错误，还请指正。本篇主要是编译器具体实现。
The Super Tiny Compiler（上）
正文翻译中…
THE"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="weyos"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://yoursite.com/img/rickandmotry2.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="http://yoursite.com/img/rickandmotry2.jpg"/>
    

    <!-- Title -->
    
    <title>The Super Tiny Compiler（下） - weyos</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">weyos</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/rickandmotry2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>The Super Tiny Compiler（下）</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2018-12-09
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/ast/">#ast</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/技术分享/">技术分享</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="The-Super-Tiny-Compiler（下）"><a href="#The-Super-Tiny-Compiler（下）" class="headerlink" title="The Super Tiny Compiler（下）"></a>The Super Tiny Compiler（下）</h1><p>本文是<a href="https://github.com/jamiebuilds/the-super-tiny-compiler" target="_blank" rel="noopener"><code>The Super Tiny Compiler</code></a>的翻译，可以通过本文学习如何实现一个编译器。<br>本文并非严格按照字面直译，如有理解错误，还请指正。<br>本篇主要是编译器具体实现。</p>
<p><strong><em><a href="/2018/12/09/ast-part1/">The Super Tiny Compiler（上）</a></em></strong></p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>翻译中…</p>
<h3 id="THE-TOKENIZER"><a href="#THE-TOKENIZER" class="headerlink" title="THE TOKENIZER"></a>THE TOKENIZER</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                   (/^▽^)/</span></span><br><span class="line"><span class="comment"> *                                THE TOKENIZER!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 我们通过tokenizer开始第一阶段的解析，词法分析</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 我们需要把这串代码分解成一个tokens数组。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   (add 2 (subtract 4 2))   =&gt;   [&#123; type: 'paren', value: '(' &#125;, ...]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// We start by accepting an input string of code, and we're gonna set up two</span></span><br><span class="line"><span class="comment">// things...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tokenizer</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过`current`变量，标记光标在代码的具体位置</span></span><br><span class="line">  <span class="keyword">let</span> current = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 解析到的tokens将被push近`tokens`数组</span></span><br><span class="line">  <span class="keyword">let</span> tokens = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建一个while循环，在循环内部根据自己的期望来改变current变量值</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// 这么做是因为，我们有可能希望在一个循环中多次增加`current`，因为tokens可以是任意长度的</span></span><br><span class="line">  <span class="keyword">while</span> (current &lt; input.length) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取当前聚焦的字符</span></span><br><span class="line">    <span class="keyword">let</span> char = input[current];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第一件事，我们想先检查括号，它会被用于可执行表达式中，但是现在先把他作为字符</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// 检查是否有括号</span></span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">'('</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 如果检查到了有括号，则push一个新的token，type为`paren`，value为括号本身</span></span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: <span class="string">'paren'</span>,</span><br><span class="line">        value: <span class="string">'('</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 然后增加`current`</span></span><br><span class="line">      current++;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 然后使用`continue`进入下一个循环周期</span></span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next we're going to check for a closing parenthesis. We do the same exact</span></span><br><span class="line">    <span class="comment">// thing as before: Check for a closing parenthesis, add a new token,</span></span><br><span class="line">    <span class="comment">// increment `current`, and `continue`.</span></span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">')'</span>) &#123;</span><br><span class="line">      tokens.push(&#123;</span><br><span class="line">        type: <span class="string">'paren'</span>,</span><br><span class="line">        value: <span class="string">')'</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      current++;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Moving on, we're now going to check for whitespace. This is interesting</span></span><br><span class="line">    <span class="comment">// because we care that whitespace exists to separate characters, but it</span></span><br><span class="line">    <span class="comment">// isn't actually important for us to store as a token. We would only throw</span></span><br><span class="line">    <span class="comment">// it out later.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// So here we're just going to test for existence and if it does exist we're</span></span><br><span class="line">    <span class="comment">// going to just `continue` on.</span></span><br><span class="line">    <span class="keyword">let</span> WHITESPACE = <span class="regexp">/\s/</span>;</span><br><span class="line">    <span class="keyword">if</span> (WHITESPACE.test(char)) &#123;</span><br><span class="line">      current++;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The next type of token is a number. This is different than what we have</span></span><br><span class="line">    <span class="comment">// seen before because a number could be any number of characters and we</span></span><br><span class="line">    <span class="comment">// want to capture the entire sequence of characters as one token.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//   (add 123 456)</span></span><br><span class="line">    <span class="comment">//        ^^^ ^^^</span></span><br><span class="line">    <span class="comment">//        Only two separate tokens</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// So we start this off when we encounter the first number in a sequence.</span></span><br><span class="line">    <span class="keyword">let</span> NUMBERS = <span class="regexp">/[0-9]/</span>;</span><br><span class="line">    <span class="keyword">if</span> (NUMBERS.test(char)) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We're going to create a `value` string that we are going to push</span></span><br><span class="line">      <span class="comment">// characters to.</span></span><br><span class="line">      <span class="keyword">let</span> value = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Then we're going to loop through each character in the sequence until</span></span><br><span class="line">      <span class="comment">// we encounter a character that is not a number, pushing each character</span></span><br><span class="line">      <span class="comment">// that is a number to our `value` and incrementing `current` as we go.</span></span><br><span class="line">      <span class="keyword">while</span> (NUMBERS.test(char)) &#123;</span><br><span class="line">        value += char;</span><br><span class="line">        char = input[++current];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// After that we push our `number` token to the `tokens` array.</span></span><br><span class="line">      tokens.push(&#123; <span class="attr">type</span>: <span class="string">'number'</span>, value &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And we continue on.</span></span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We'll also add support for strings in our language which will be any</span></span><br><span class="line">    <span class="comment">// text surrounded by double quotes (").</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//   (concat "foo" "bar")</span></span><br><span class="line">    <span class="comment">//            ^^^   ^^^ string tokens</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// We'll start by checking for the opening quote:</span></span><br><span class="line">    <span class="keyword">if</span> (char === <span class="string">'"'</span>) &#123;</span><br><span class="line">      <span class="comment">// Keep a `value` variable for building up our string token.</span></span><br><span class="line">      <span class="keyword">let</span> value = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We'll skip the opening double quote in our token.</span></span><br><span class="line">      char = input[++current];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Then we'll iterate through each character until we reach another</span></span><br><span class="line">      <span class="comment">// double quote.</span></span><br><span class="line">      <span class="keyword">while</span> (char !== <span class="string">'"'</span>) &#123;</span><br><span class="line">        value += char;</span><br><span class="line">        char = input[++current];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Skip the closing double quote.</span></span><br><span class="line">      char = input[++current];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And add our `string` token to the `tokens` array.</span></span><br><span class="line">      tokens.push(&#123; <span class="attr">type</span>: <span class="string">'string'</span>, value &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The last type of token will be a `name` token. This is a sequence of</span></span><br><span class="line">    <span class="comment">// letters instead of numbers, that are the names of functions in our lisp</span></span><br><span class="line">    <span class="comment">// syntax.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//   (add 2 4)</span></span><br><span class="line">    <span class="comment">//    ^^^</span></span><br><span class="line">    <span class="comment">//    Name token</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">let</span> LETTERS = <span class="regexp">/[a-z]/i</span>;</span><br><span class="line">    <span class="keyword">if</span> (LETTERS.test(char)) &#123;</span><br><span class="line">      <span class="keyword">let</span> value = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Again we're just going to loop through all the letters pushing them to</span></span><br><span class="line">      <span class="comment">// a value.</span></span><br><span class="line">      <span class="keyword">while</span> (LETTERS.test(char)) &#123;</span><br><span class="line">        value += char;</span><br><span class="line">        char = input[++current];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And pushing that value as a token with the type `name` and continuing.</span></span><br><span class="line">      tokens.push(&#123; <span class="attr">type</span>: <span class="string">'name'</span>, value &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Finally if we have not matched a character by now, we're going to throw</span></span><br><span class="line">    <span class="comment">// an error and completely exit.</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'I dont know what this character is: '</span> + char);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Then at the end of our `tokenizer` we simply return the tokens array.</span></span><br><span class="line">  <span class="keyword">return</span> tokens;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="THE-PARSER"><a href="#THE-PARSER" class="headerlink" title="THE PARSER"></a>THE PARSER</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                 ヽ/❀o ل͜ o\ﾉ</span></span><br><span class="line"><span class="comment"> *                                THE PARSER!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * For our parser we're going to take our array of tokens and turn it into an</span></span><br><span class="line"><span class="comment"> * AST.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   [&#123; type: 'paren', value: '(' &#125;, ...]   =&gt;   &#123; type: 'Program', body: [...] &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Okay, so we define a `parser` function that accepts our array of `tokens`.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parser</span>(<span class="params">tokens</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Again we keep a `current` variable that we will use as a cursor.</span></span><br><span class="line">  <span class="keyword">let</span> current = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// But this time we're going to use recursion instead of a `while` loop. So we</span></span><br><span class="line">  <span class="comment">// define a `walk` function.</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Inside the walk function we start by grabbing the `current` token.</span></span><br><span class="line">    <span class="keyword">let</span> token = tokens[current];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We're going to split each type of token off into a different code path,</span></span><br><span class="line">    <span class="comment">// starting off with `number` tokens.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// We test to see if we have a `number` token.</span></span><br><span class="line">    <span class="keyword">if</span> (token.type === <span class="string">'number'</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// If we have one, we'll increment `current`.</span></span><br><span class="line">      current++;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And we'll return a new AST node called `NumberLiteral` and setting its</span></span><br><span class="line">      <span class="comment">// value to the value of our token.</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        type: <span class="string">'NumberLiteral'</span>,</span><br><span class="line">        value: token.value,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we have a string we will do the same as number and create a</span></span><br><span class="line">    <span class="comment">// `StringLiteral` node.</span></span><br><span class="line">    <span class="keyword">if</span> (token.type === <span class="string">'string'</span>) &#123;</span><br><span class="line">      current++;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        type: <span class="string">'StringLiteral'</span>,</span><br><span class="line">        value: token.value,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next we're going to look for CallExpressions. We start this off when we</span></span><br><span class="line">    <span class="comment">// encounter an open parenthesis.</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      token.type === <span class="string">'paren'</span> &amp;&amp;</span><br><span class="line">      token.value === <span class="string">'('</span></span><br><span class="line">    ) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We'll increment `current` to skip the parenthesis since we don't care</span></span><br><span class="line">      <span class="comment">// about it in our AST.</span></span><br><span class="line">      token = tokens[++current];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We create a base node with the type `CallExpression`, and we're going</span></span><br><span class="line">      <span class="comment">// to set the name as the current token's value since the next token after</span></span><br><span class="line">      <span class="comment">// the open parenthesis is the name of the function.</span></span><br><span class="line">      <span class="keyword">let</span> node = &#123;</span><br><span class="line">        type: <span class="string">'CallExpression'</span>,</span><br><span class="line">        name: token.value,</span><br><span class="line">        params: [],</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We increment `current` *again* to skip the name token.</span></span><br><span class="line">      token = tokens[++current];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And now we want to loop through each token that will be the `params` of</span></span><br><span class="line">      <span class="comment">// our `CallExpression` until we encounter a closing parenthesis.</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">// Now this is where recursion comes in. Instead of trying to parse a</span></span><br><span class="line">      <span class="comment">// potentially infinitely nested set of nodes we're going to rely on</span></span><br><span class="line">      <span class="comment">// recursion to resolve things.</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">// To explain this, let's take our Lisp code. You can see that the</span></span><br><span class="line">      <span class="comment">// parameters of the `add` are a number and a nested `CallExpression` that</span></span><br><span class="line">      <span class="comment">// includes its own numbers.</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">//   (add 2 (subtract 4 2))</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">// You'll also notice that in our tokens array we have multiple closing</span></span><br><span class="line">      <span class="comment">// parenthesis.</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">//   [</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'paren',  value: '('        &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'name',   value: 'add'      &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'number', value: '2'        &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'paren',  value: '('        &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'name',   value: 'subtract' &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'number', value: '4'        &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'number', value: '2'        &#125;,</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'paren',  value: ')'        &#125;, &lt;&lt;&lt; Closing parenthesis</span></span><br><span class="line">      <span class="comment">//     &#123; type: 'paren',  value: ')'        &#125;, &lt;&lt;&lt; Closing parenthesis</span></span><br><span class="line">      <span class="comment">//   ]</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">// We're going to rely on the nested `walk` function to increment our</span></span><br><span class="line">      <span class="comment">// `current` variable past any nested `CallExpression`.</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// So we create a `while` loop that will continue until it encounters a</span></span><br><span class="line">      <span class="comment">// token with a `type` of `'paren'` and a `value` of a closing</span></span><br><span class="line">      <span class="comment">// parenthesis.</span></span><br><span class="line">      <span class="keyword">while</span> (</span><br><span class="line">        (token.type !== <span class="string">'paren'</span>) ||</span><br><span class="line">        (token.type === <span class="string">'paren'</span> &amp;&amp; token.value !== <span class="string">')'</span>)</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="comment">// we'll call the `walk` function which will return a `node` and we'll</span></span><br><span class="line">        <span class="comment">// push it into our `node.params`.</span></span><br><span class="line">        node.params.push(walk());</span><br><span class="line">        token = tokens[current];</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Finally we will increment `current` one last time to skip the closing</span></span><br><span class="line">      <span class="comment">// parenthesis.</span></span><br><span class="line">      current++;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And return the node.</span></span><br><span class="line">      <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Again, if we haven't recognized the token type by now we're going to</span></span><br><span class="line">    <span class="comment">// throw an error.</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(token.type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Now, we're going to create our AST which will have a root which is a</span></span><br><span class="line">  <span class="comment">// `Program` node.</span></span><br><span class="line">  <span class="keyword">let</span> ast = &#123;</span><br><span class="line">    type: <span class="string">'Program'</span>,</span><br><span class="line">    body: [],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// And we're going to kickstart our `walk` function, pushing nodes to our</span></span><br><span class="line">  <span class="comment">// `ast.body` array.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// The reason we are doing this inside a loop is because our program can have</span></span><br><span class="line">  <span class="comment">// `CallExpression` after one another instead of being nested.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">//   (add 2 2)</span></span><br><span class="line">  <span class="comment">//   (subtract 4 2)</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">while</span> (current &lt; tokens.length) &#123;</span><br><span class="line">    ast.body.push(walk());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// At the end of our parser we'll return the AST.</span></span><br><span class="line">  <span class="keyword">return</span> ast;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="THE-TRAVERSER"><a href="#THE-TRAVERSER" class="headerlink" title="THE TRAVERSER"></a>THE TRAVERSER</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                 ⌒(❀&gt;◞౪◟&lt;❀)⌒</span></span><br><span class="line"><span class="comment"> *                               THE TRAVERSER!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * So now we have our AST, and we want to be able to visit different nodes with</span></span><br><span class="line"><span class="comment"> * a visitor. We need to be able to call the methods on the visitor whenever we</span></span><br><span class="line"><span class="comment"> * encounter a node with a matching type.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   traverse(ast, &#123;</span></span><br><span class="line"><span class="comment"> *     Program: &#123;</span></span><br><span class="line"><span class="comment"> *       enter(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *       exit(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *     &#125;,</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     CallExpression: &#123;</span></span><br><span class="line"><span class="comment"> *       enter(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *       exit(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *     &#125;,</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     NumberLiteral: &#123;</span></span><br><span class="line"><span class="comment"> *       enter(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *       exit(node, parent) &#123;</span></span><br><span class="line"><span class="comment"> *         // ...</span></span><br><span class="line"><span class="comment"> *       &#125;,</span></span><br><span class="line"><span class="comment"> *     &#125;,</span></span><br><span class="line"><span class="comment"> *   &#125;);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// So we define a traverser function which accepts an AST and a</span></span><br><span class="line"><span class="comment">// visitor. Inside we're going to define two functions...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">traverser</span>(<span class="params">ast, visitor</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A `traverseArray` function that will allow us to iterate over an array and</span></span><br><span class="line">  <span class="comment">// call the next function that we will define: `traverseNode`.</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">traverseArray</span>(<span class="params">array, parent</span>) </span>&#123;</span><br><span class="line">    array.forEach(<span class="function"><span class="params">child</span> =&gt;</span> &#123;</span><br><span class="line">      traverseNode(child, parent);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `traverseNode` will accept a `node` and its `parent` node. So that it can</span></span><br><span class="line">  <span class="comment">// pass both to our visitor methods.</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">traverseNode</span>(<span class="params">node, parent</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We start by testing for the existence of a method on the visitor with a</span></span><br><span class="line">    <span class="comment">// matching `type`.</span></span><br><span class="line">    <span class="keyword">let</span> methods = visitor[node.type];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If there is an `enter` method for this node type we'll call it with the</span></span><br><span class="line">    <span class="comment">// `node` and its `parent`.</span></span><br><span class="line">    <span class="keyword">if</span> (methods &amp;&amp; methods.enter) &#123;</span><br><span class="line">      methods.enter(node, parent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next we are going to split things up by the current node type.</span></span><br><span class="line">    <span class="keyword">switch</span> (node.type) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// We'll start with our top level `Program`. Since Program nodes have a</span></span><br><span class="line">      <span class="comment">// property named body that has an array of nodes, we will call</span></span><br><span class="line">      <span class="comment">// `traverseArray` to traverse down into them.</span></span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="comment">// (Remember that `traverseArray` will in turn call `traverseNode` so  we</span></span><br><span class="line">      <span class="comment">// are causing the tree to be traversed recursively)</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'Program'</span>:</span><br><span class="line">        traverseArray(node.body, node);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Next we do the same with `CallExpression` and traverse their `params`.</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'CallExpression'</span>:</span><br><span class="line">        traverseArray(node.params, node);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// In the cases of `NumberLiteral` and `StringLiteral` we don't have any</span></span><br><span class="line">      <span class="comment">// child nodes to visit, so we'll just break.</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'NumberLiteral'</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'StringLiteral'</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// And again, if we haven't recognized the node type then we'll throw an</span></span><br><span class="line">      <span class="comment">// error.</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(node.type);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If there is an `exit` method for this node type we'll call it with the</span></span><br><span class="line">    <span class="comment">// `node` and its `parent`.</span></span><br><span class="line">    <span class="keyword">if</span> (methods &amp;&amp; methods.exit) &#123;</span><br><span class="line">      methods.exit(node, parent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Finally we kickstart the traverser by calling `traverseNode` with our ast</span></span><br><span class="line">  <span class="comment">// with no `parent` because the top level of the AST doesn't have a parent.</span></span><br><span class="line">  traverseNode(ast, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="THE-TRANSFORMER"><a href="#THE-TRANSFORMER" class="headerlink" title="THE TRANSFORMER"></a>THE TRANSFORMER</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                   ⁽(◍˃̵͈̑ᴗ˂̵͈̑)⁽</span></span><br><span class="line"><span class="comment"> *                              THE TRANSFORMER!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Next up, the transformer. Our transformer is going to take the AST that we</span></span><br><span class="line"><span class="comment"> * have built and pass it to our traverser function with a visitor and will</span></span><br><span class="line"><span class="comment"> * create a new ast.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"> *   Original AST                     |   Transformed AST</span></span><br><span class="line"><span class="comment"> * ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"> *   &#123;                                |   &#123;</span></span><br><span class="line"><span class="comment"> *     type: 'Program',               |     type: 'Program',</span></span><br><span class="line"><span class="comment"> *     body: [&#123;                       |     body: [&#123;</span></span><br><span class="line"><span class="comment"> *       type: 'CallExpression',      |       type: 'ExpressionStatement',</span></span><br><span class="line"><span class="comment"> *       name: 'add',                 |       expression: &#123;</span></span><br><span class="line"><span class="comment"> *       params: [&#123;                   |         type: 'CallExpression',</span></span><br><span class="line"><span class="comment"> *         type: 'NumberLiteral',     |         callee: &#123;</span></span><br><span class="line"><span class="comment"> *         value: '2'                 |           type: 'Identifier',</span></span><br><span class="line"><span class="comment"> *       &#125;, &#123;                         |           name: 'add'</span></span><br><span class="line"><span class="comment"> *         type: 'CallExpression',    |         &#125;,</span></span><br><span class="line"><span class="comment"> *         name: 'subtract',          |         arguments: [&#123;</span></span><br><span class="line"><span class="comment"> *         params: [&#123;                 |           type: 'NumberLiteral',</span></span><br><span class="line"><span class="comment"> *           type: 'NumberLiteral',   |           value: '2'</span></span><br><span class="line"><span class="comment"> *           value: '4'               |         &#125;, &#123;</span></span><br><span class="line"><span class="comment"> *         &#125;, &#123;                       |           type: 'CallExpression',</span></span><br><span class="line"><span class="comment"> *           type: 'NumberLiteral',   |           callee: &#123;</span></span><br><span class="line"><span class="comment"> *           value: '2'               |             type: 'Identifier',</span></span><br><span class="line"><span class="comment"> *         &#125;]                         |             name: 'subtract'</span></span><br><span class="line"><span class="comment"> *       &#125;]                           |           &#125;,</span></span><br><span class="line"><span class="comment"> *     &#125;]                             |           arguments: [&#123;</span></span><br><span class="line"><span class="comment"> *   &#125;                                |             type: 'NumberLiteral',</span></span><br><span class="line"><span class="comment"> *                                    |             value: '4'</span></span><br><span class="line"><span class="comment"> * ---------------------------------- |           &#125;, &#123;</span></span><br><span class="line"><span class="comment"> *                                    |             type: 'NumberLiteral',</span></span><br><span class="line"><span class="comment"> *                                    |             value: '2'</span></span><br><span class="line"><span class="comment"> *                                    |           &#125;]</span></span><br><span class="line"><span class="comment"> *  (sorry the other one is longer.)  |         &#125;</span></span><br><span class="line"><span class="comment"> *                                    |       &#125;</span></span><br><span class="line"><span class="comment"> *                                    |     &#125;]</span></span><br><span class="line"><span class="comment"> *                                    |   &#125;</span></span><br><span class="line"><span class="comment"> * ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// So we have our transformer function which will accept the lisp ast.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transformer</span>(<span class="params">ast</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We'll create a `newAst` which like our previous AST will have a program</span></span><br><span class="line">  <span class="comment">// node.</span></span><br><span class="line">  <span class="keyword">let</span> newAst = &#123;</span><br><span class="line">    type: <span class="string">'Program'</span>,</span><br><span class="line">    body: [],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Next I'm going to cheat a little and create a bit of a hack. We're going to</span></span><br><span class="line">  <span class="comment">// use a property named `context` on our parent nodes that we're going to push</span></span><br><span class="line">  <span class="comment">// nodes to their parent's `context`. Normally you would have a better</span></span><br><span class="line">  <span class="comment">// abstraction than this, but for our purposes this keeps things simple.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Just take note that the context is a reference *from* the old ast *to* the</span></span><br><span class="line">  <span class="comment">// new ast.</span></span><br><span class="line">  ast._context = newAst.body;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We'll start by calling the traverser function with our ast and a visitor.</span></span><br><span class="line">  traverser(ast, &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The first visitor method accepts any `NumberLiteral`</span></span><br><span class="line">    NumberLiteral: &#123;</span><br><span class="line">      <span class="comment">// We'll visit them on enter.</span></span><br><span class="line">      enter(node, parent) &#123;</span><br><span class="line">        <span class="comment">// We'll create a new node also named `NumberLiteral` that we will push to</span></span><br><span class="line">        <span class="comment">// the parent context.</span></span><br><span class="line">        parent._context.push(&#123;</span><br><span class="line">          type: <span class="string">'NumberLiteral'</span>,</span><br><span class="line">          value: node.value,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next we have `StringLiteral`</span></span><br><span class="line">    StringLiteral: &#123;</span><br><span class="line">      enter(node, parent) &#123;</span><br><span class="line">        parent._context.push(&#123;</span><br><span class="line">          type: <span class="string">'StringLiteral'</span>,</span><br><span class="line">          value: node.value,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Next up, `CallExpression`.</span></span><br><span class="line">    CallExpression: &#123;</span><br><span class="line">      enter(node, parent) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// We start creating a new node `CallExpression` with a nested</span></span><br><span class="line">        <span class="comment">// `Identifier`.</span></span><br><span class="line">        <span class="keyword">let</span> expression = &#123;</span><br><span class="line">          type: <span class="string">'CallExpression'</span>,</span><br><span class="line">          callee: &#123;</span><br><span class="line">            type: <span class="string">'Identifier'</span>,</span><br><span class="line">            name: node.name,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="built_in">arguments</span>: [],</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Next we're going to define a new context on the original</span></span><br><span class="line">        <span class="comment">// `CallExpression` node that will reference the `expression`'s arguments</span></span><br><span class="line">        <span class="comment">// so that we can push arguments.</span></span><br><span class="line">        node._context = expression.arguments;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Then we're going to check if the parent node is a `CallExpression`.</span></span><br><span class="line">        <span class="comment">// If it is not...</span></span><br><span class="line">        <span class="keyword">if</span> (parent.type !== <span class="string">'CallExpression'</span>) &#123;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// We're going to wrap our `CallExpression` node with an</span></span><br><span class="line">          <span class="comment">// `ExpressionStatement`. We do this because the top level</span></span><br><span class="line">          <span class="comment">// `CallExpression` in JavaScript are actually statements.</span></span><br><span class="line">          expression = &#123;</span><br><span class="line">            type: <span class="string">'ExpressionStatement'</span>,</span><br><span class="line">            expression: expression,</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Last, we push our (possibly wrapped) `CallExpression` to the `parent`'s</span></span><br><span class="line">        <span class="comment">// `context`.</span></span><br><span class="line">        parent._context.push(expression);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// At the end of our transformer function we'll return the new ast that we</span></span><br><span class="line">  <span class="comment">// just created.</span></span><br><span class="line">  <span class="keyword">return</span> newAst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="THE-CODE-GENERATOR"><a href="#THE-CODE-GENERATOR" class="headerlink" title="THE CODE GENERATOR"></a>THE CODE GENERATOR</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                               ヾ（〃＾∇＾）ﾉ♪</span></span><br><span class="line"><span class="comment"> *                            THE CODE GENERATOR!!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Now let's move onto our last phase: The Code Generator.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Our code generator is going to recursively call itself to print each node in</span></span><br><span class="line"><span class="comment"> * the tree into one giant string.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">codeGenerator</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We'll break things down by the `type` of the `node`.</span></span><br><span class="line">  <span class="keyword">switch</span> (node.type) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we have a `Program` node. We will map through each node in the `body`</span></span><br><span class="line">    <span class="comment">// and run them through the code generator and join them with a newline.</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Program'</span>:</span><br><span class="line">      <span class="keyword">return</span> node.body.map(codeGenerator)</span><br><span class="line">        .join(<span class="string">'\n'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For `ExpressionStatement` we'll call the code generator on the nested</span></span><br><span class="line">    <span class="comment">// expression and we'll add a semicolon...</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'ExpressionStatement'</span>:</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        codeGenerator(node.expression) +</span><br><span class="line">        <span class="string">';'</span> <span class="comment">// &lt;&lt; (...because we like to code the *correct* way)</span></span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For `CallExpression` we will print the `callee`, add an open</span></span><br><span class="line">    <span class="comment">// parenthesis, we'll map through each node in the `arguments` array and run</span></span><br><span class="line">    <span class="comment">// them through the code generator, joining them with a comma, and then</span></span><br><span class="line">    <span class="comment">// we'll add a closing parenthesis.</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'CallExpression'</span>:</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        codeGenerator(node.callee) +</span><br><span class="line">        <span class="string">'('</span> +</span><br><span class="line">        node.arguments.map(codeGenerator)</span><br><span class="line">          .join(<span class="string">', '</span>) +</span><br><span class="line">        <span class="string">')'</span></span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For `Identifier` we'll just return the `node`'s name.</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Identifier'</span>:</span><br><span class="line">      <span class="keyword">return</span> node.name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For `NumberLiteral` we'll just return the `node`'s value.</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'NumberLiteral'</span>:</span><br><span class="line">      <span class="keyword">return</span> node.value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For `StringLiteral` we'll add quotations around the `node`'s value.</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">'StringLiteral'</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'"'</span> + node.value + <span class="string">'"'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// And if we haven't recognized the node, we'll throw an error.</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(node.type);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="THE-COMPILER"><a href="#THE-COMPILER" class="headerlink" title="THE COMPILER"></a>THE COMPILER</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                  (۶* ‘ヮ’)۶”</span></span><br><span class="line"><span class="comment"> *                         !!!!!!!!THE COMPILER!!!!!!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * FINALLY! We'll create our `compiler` function. Here we will link together</span></span><br><span class="line"><span class="comment"> * every part of the pipeline.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *   1. input  =&gt; tokenizer   =&gt; tokens</span></span><br><span class="line"><span class="comment"> *   2. tokens =&gt; parser      =&gt; ast</span></span><br><span class="line"><span class="comment"> *   3. ast    =&gt; transformer =&gt; newAst</span></span><br><span class="line"><span class="comment"> *   4. newAst =&gt; generator   =&gt; output</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compiler</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> tokens = tokenizer(input);</span><br><span class="line">  <span class="keyword">let</span> ast    = parser(tokens);</span><br><span class="line">  <span class="keyword">let</span> newAst = transformer(ast);</span><br><span class="line">  <span class="keyword">let</span> output = codeGenerator(newAst);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// and simply return the output!</span></span><br><span class="line">  <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> *                                   (๑˃̵ᴗ˂̵)و</span></span><br><span class="line"><span class="comment"> * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!YOU MADE IT!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br><span class="line"><span class="comment"> * ============================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Now I'm just exporting everything...</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  tokenizer,</span><br><span class="line">  parser,</span><br><span class="line">  traverser,</span><br><span class="line">  transformer,</span><br><span class="line">  codeGenerator,</span><br><span class="line">  compiler,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong><em><a href="/2018/12/09/ast-part1/">The Super Tiny Compiler（上）</a></em></strong></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/weyos" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2018 weyos<br></p>
                <!-- <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p> -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>